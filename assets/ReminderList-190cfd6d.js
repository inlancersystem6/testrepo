import{o as l,d,F as b,e as C,f as g,a as e,t as y,n as E,s as G,p as I,g as M,u as T,h as f,i as k,r as _,j as h,w,c as D}from"./index-38024ad5.js";import{L as B,D as A}from"./Layout-200f36b8.js";import{C as V,S as O,P as z,_ as j}from"./adjustments-e0be9a7b.js";import{T as q}from"./TextArea-abd90eb3.js";import{L as H}from"./Label-dfa7b7c9.js";import{_ as W,a as Y}from"./trash-bad6200c.js";import{_ as J}from"./edit-51d5eb37.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";import{M as K}from"./Modal-e622034b.js";import"./OverLaye-d6a130a2.js";import"./search-0186349c.js";const Q={props:{list:Array,loading:Boolean},data(){return{showStatus:[]}},mounted(){document.addEventListener("click",this.closeStatusOnClickOutside)},beforeUnmount(){document.removeEventListener("click",this.closeStatusOnClickOutside)},methods:{closeStatusOnClickOutside(t){t.target.closest(".user-status")||this.closeStatus()},deleteItem(t){this.showStatus=[],this.$emit("delete_item",t)},editItem(t){this.showStatus=[],this.$emit("edit_item",t)},editStatus(t,s){this.$emit("edit_status",t,s),this.showStatus=[]},statusShow(t){this.showStatus=[],this.showStatus[t]=!this.showStatus[t]},closeStatus(){this.showStatus=[]}}},i=t=>(I("data-v-af0b691d"),t=t(),M(),t),X={key:0},Z=i(()=>e("td",{class:"count skeleton-element"},null,-1)),ee=i(()=>e("td",{class:"user_name skeleton-element"},null,-1)),te=i(()=>e("td",{class:"user_number skeleton-element"},null,-1)),se=i(()=>e("td",{class:"user_address skeleton-element"},null,-1)),oe=i(()=>e("td",{class:"blank"},null,-1)),ae=i(()=>e("td",{class:"user-status relative skeleton-element"},null,-1)),re=i(()=>e("td",{class:"dropdown skeleton-element"},null,-1)),ne=[Z,ee,te,se,oe,ae,re],le={key:0},ie={class:"count"},de={class:"gap-8px text-sm_regular color-Grey_90"},ce={class:"user_name"},_e={class:"display-flex align-center gap-14px"},me={class:"text-sm_regular color-Grey_90"},ue={class:"user_number"},pe={class:"text-sm_regular color-Grey_90"},he={class:"user_address"},ge={class:"text-sm_regular color-Grey_90 line-clamp-1"},we=i(()=>e("td",{class:"blank"},null,-1)),be={class:"user-status relative"},ye=["onClick"],fe={class:"text-sm_medium color-Grey_60 capitalize"},ke=["onClick"],ve=i(()=>e("div",{class:"dropdown-link"},[e("p",{class:"dropdown-link-title capitalize"}," pending ")],-1)),Se=[ve],De=["onClick"],xe=i(()=>e("div",{class:"dropdown-link"},[e("p",{class:"dropdown-link-title capitalize"}," unanswered ")],-1)),Ce=[xe],Ie=["onClick"],Me=i(()=>e("div",{class:"dropdown-link"},[e("p",{class:"dropdown-link-title capitalize"}," complete ")],-1)),Pe=[Me],Le={class:"dropdown"},$e={class:"icon-btn icon-btn_32px custom-dropdown"},Fe=i(()=>e("img",{src:W},null,-1)),Ne={class:"custom-dropdown-list leftside icon-dropdown"},Re=["onClick"],Ue=i(()=>e("div",{class:"dropdown-link"},[e("img",{src:J}),e("p",{class:"dropdown-link-title"}," Edit Follow Up ")],-1)),Ee=[Ue],Ge=["onClick"],Te=i(()=>e("div",{class:"dropdown-link"},[e("img",{src:Y}),e("p",{class:"dropdown-link-title required"}," Delete Follow Up ")],-1)),Be=[Te];function Ae(t,s,o,u,r,a){return l(),d(b,null,[(l(),d(b,null,C(6,(n,p)=>(l(),d(b,{key:p},[o.loading?(l(),d("tr",X,ne)):g("",!0)],64))),64)),(l(!0),d(b,null,C(o.list,(n,p)=>(l(),d(b,{key:p},[o.loading?g("",!0):(l(),d("tr",le,[e("td",ie,[e("p",de,y(p+1),1)]),e("td",ce,[e("div",_e,[e("p",me,y(n.rem_cus),1)])]),e("td",ue,[e("p",pe,y(n.rem_date),1)]),e("td",he,[e("p",ge,y(n.rem_notes),1)]),we,e("td",be,[e("button",{class:"btn-regular display-flex align-center gap-8px",onClick:m=>a.statusShow(p)},[e("div",{class:E(["ellipse-dot",{"bg-emerald":n.rem_status_id===3,"bg-orange":n.rem_status_id===2,"bg-Grey_40":n.rem_status_id===1}])},null,2),e("p",fe,y(n.rem_status),1)],8,ye),r.showStatus[p]&&n.rem_status_id!==3?(l(),d("ul",{key:0,class:"custom-dropdown-list",onClick:s[0]||(s[0]=G((...m)=>a.closeStatus&&a.closeStatus(...m),["self"]))},[e("li",{class:"dropdown-item",onClick:m=>a.editStatus(n.rem_id,1)},Se,8,ke),e("li",{class:"dropdown-item",onClick:m=>a.editStatus(n.rem_id,2)},Ce,8,De),e("li",{class:"dropdown-item",onClick:m=>a.editStatus(n.rem_id,3)},Pe,8,Ie)])):g("",!0)]),e("td",Le,[e("div",$e,[Fe,e("ul",Ne,[e("li",{class:"dropdown-item",onClick:m=>a.editItem(n.rem_id)},Ee,8,Re),e("li",{class:"dropdown-item",onClick:m=>a.deleteItem(n.rem_id)},Be,8,Ge)])])])]))],64))),128))],64)}const Ve=P(Q,[["render",Ae],["__scopeId","data-v-af0b691d"]]);const v="https://devapi.billionbuild.com",Oe={components:{Layout:B,ContentSection:V,SearchBox:O,Pagination:z,DeleteModel:A,reminderRow:Ve,Modal:K,TextArea:q,Label:H},data(){return{list:[],currentPage:1,totalPages:1,sort:"asc",deleteItemModal:!1,itemId:"",remDate:"",remNote:"",reminderModal:!1,attributes:[],listLoading:!1,listEmpty:!1}},created(){this.reminderData();const t=T(),s="Follow Up List |  Billion Build",o="this is description for Follow Up List";t.chnageTitle(s,o)},computed:{remBtnDisabled(){const t=/[!@#$%^&*()?":{}|<>]/;return!this.remDate||!this.remNote.trim()||t.test(this.remNote)},formattedDate(){const t=new Date(this.remDate),s=t.getFullYear(),o=`0${t.getMonth()+1}`.slice(-2),u=`0${t.getDate()}`.slice(-2),r=`0${t.getHours()}`.slice(-2),a=`0${t.getMinutes()}`.slice(-2),n=`0${t.getSeconds()}`.slice(-2);return`${s}-${o}-${u} ${r}:${a}:${n}`}},methods:{updatePage(t){this.currentPage=t,this.reminderData()},changesort(){this.sort=this.sort==="desc"?"asc":"desc",this.reminderData()},async reminderData(){this.listLoading=!0,this.listEmpty=!1;var t=new FormData;t.append("rem_id",""),t.append("sort",this.sort),t.append("page_no",this.currentPage);try{const s=await f.post(`${v}/reminder-list`,t);s.data.length!==0?(this.listLoading=!1,this.list=s.data,this.totalPages=s.total_pages):(this.listEmpty=!0,this.totalPages=1)}catch(s){k().error(s)}},async statusUpdate(t,s){var o=new FormData;o.append("rem_id",t),o.append("rem_status",s);try{(await f.post(`${v}/reminder-status`,o)).success===1&&this.reminderData()}catch(u){k().error(u)}},getItemId(t){this.deleteItemModal=!0,this.itemId=t},editItem(t){this.itemId=t,this.reminderModal=!0,this.getReminderData(t)},async getReminderData(t){var s=new FormData;s.append("rem_id",t),s.append("sort",this.sort),s.append("page_no",this.currentPage);try{const o=await f.post(`${v}/reminder-list`,s);this.totalPages=o.total_pages,o.success===1&&(this.remNote=o.data.rem_notes,this.remDate=o.data.rem_date,this.attributes={content:"blue",highlight:!0,dot:!0,bar:!1,popover:{title:"Reminder",label:o.data.rem_notes},dates:new Date(o.data.rem_date),order:1,time:new Date(o.data.rem_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})}catch(o){k().error(o)}},dateTimeFormatter(t){const s={year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(t).toLocaleString([],s)},async addReminder(){var t=new FormData;t.append("rem_id",this.itemId),t.append("rem_self",""),t.append("cus_id",this.itemId),t.append("rem_notes",this.remNote);const s=this.formattedDate;t.append("rem_date",s);try{(await f.post(`${v}/add-reminder`,t)).success===1&&(this.reminderModal=!1,this.reminderData())}catch(o){k().error(o)}},async deleteItem(){var t=new FormData;t.append("rem_id",this.itemId);try{(await f.post(`${v}/reminder-delete`,t)).success===1&&(this.reminderData(),this.deleteItemModal=!1)}catch(s){k().error(s)}}}},S=t=>(I("data-v-6e5888a3"),t=t(),M(),t),ze=S(()=>e("div",{class:"w-100 margin-bottom_12px"},[e("h2",{class:"title"},"Follow Up List")],-1)),je=S(()=>e("div",{class:"table-options w-100"},null,-1)),qe={class:"table-options w-100 justify-end"},He=S(()=>e("img",{src:j},null,-1)),We={key:0},Ye={key:1},Je={class:"w-100 user-table"},Ke=S(()=>e("tr",null,[e("td",{class:"count"},[e("p",{class:"gap-8px text-base_semibold color-Grey_50"},"No.")]),e("td",{class:"user_name"},[e("div",{class:"display-flex align-center gap-14px"},[e("p",{class:"text-base_semibold color-Grey_50"},"Customer Name")])]),e("td",{class:"user_number"},[e("p",{class:"text-base_semibold color-Grey_50"},"Date & Time")]),e("td",{class:"user_address"},[e("p",{class:"text-base_semibold color-Grey_50 line-clamp-1"},"Note")]),e("td",{class:"blank"}),e("td",{class:"user-status relative"},[e("p",{class:"text-base_semibold color-Grey_50 line-clamp-1"},"Follow Up status")]),e("td",{class:"dropdown"},[e("div",{class:"icon-btn icon-btn_32px custom-dropdown"})])],-1)),Qe=S(()=>e("h4",null,"Add Follow Up",-1)),Xe={class:"padding-y_12px padding-x_16px"},Ze={class:"space-y-4"},et={class:"space-y-8px col-span-1"},tt={class:"space-y-8px col-span-2"},st=["disabled"];function ot(t,s,o,u,r,a){const n=_("reminderRow"),p=_("Pagination"),m=_("ContentSection"),x=_("Label"),L=_("VDatePicker"),$=_("ErrorMessage"),F=_("TextArea"),N=_("Modal"),R=_("Layout"),U=_("DeleteModel");return l(),d(b,null,[h(R,null,{default:w(()=>[h(m,null,{"table-header":w(()=>[ze,je,e("div",qe,[e("button",{class:"btn-regular display-flex align-center gap-8px",onClick:s[0]||(s[0]=c=>a.changesort())},[He,r.sort==="asc"?(l(),d("span",We,"Newest")):g("",!0),r.sort==="desc"?(l(),d("span",Ye,"Oldest")):g("",!0)])])]),"main-table":w(()=>[e("table",Je,[e("tbody",null,[Ke,h(n,{list:r.list,onDelete_item:a.getItemId,onEdit_item:a.editItem,onEdit_status:a.statusUpdate,loading:r.listLoading},null,8,["list","onDelete_item","onEdit_item","onEdit_status","loading"])])])]),"table-footer":w(()=>[h(p,{currentPage:r.currentPage,totalPages:r.totalPages,onUpdatePage:a.updatePage},null,8,["currentPage","totalPages","onUpdatePage"])]),_:1}),r.reminderModal?(l(),D(N,{key:0,onCloseModal:s[5]||(s[5]=c=>this.reminderModal=!this.reminderModal)},{header:w(()=>[Qe]),footer:w(()=>[e("button",{class:"btn-regular",onClick:s[3]||(s[3]=c=>this.reminderModal=!this.reminderModal)},"Cancel"),e("button",{class:"btn-regular bg-purple color-white",disabled:a.remBtnDisabled,onClick:s[4]||(s[4]=(...c)=>a.addReminder&&a.addReminder(...c))},"Save Follow Up",8,st)]),default:w(()=>[e("div",Xe,[e("div",Ze,[e("div",et,[h(x,{label:"Select Date"}),h(L,{modelValue:r.remDate,"onUpdate:modelValue":s[1]||(s[1]=c=>r.remDate=c),color:"sky-blue",attributes:r.attributes,mode:"dateTime",onChange:t.highlightSelectedDate,expanded:"",formatter:a.dateTimeFormatter},null,8,["modelValue","attributes","onChange","formatter"]),!r.remDate&&t.formSubmitted?(l(),D($,{key:0,msg:""})):g("",!0)]),e("div",tt,[h(x,{label:"Note (optional)"}),h(F,{placeholder:"Enter Reminder Note",id:"Note (optional)",value:r.remNote,onInput:s[2]||(s[2]=c=>r.remNote=c.target.value)},null,8,["value"])])])])]),_:1})):g("",!0)]),_:1}),r.deleteItemModal?(l(),D(U,{key:0,model_title:"Delete Remider",model_subtitle:"Are you sure you want to delete this Remider?",onClose_model:s[6]||(s[6]=c=>r.deleteItemModal=!1),onDelete_item:s[7]||(s[7]=c=>a.deleteItem())})):g("",!0)],64)}const ht=P(Oe,[["render",ot],["__scopeId","data-v-6e5888a3"]]);export{ht as default};
